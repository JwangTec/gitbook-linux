#### 进程

1. 说明:

    通常，现在的操作系统都支持多任务，意味着操作系统（给用户）造成了一种假象，(让用户觉得) 它同时能够做多件事情，事实上，它是快速地轮换执行这些任务的。Linux 内核通过使用进程，来 管理多任务。通过进程，Linux 安排不同的程序等待使用 CPU。

    有时候，计算机变得呆滞，运行缓慢，或者一个应用程序停止响应。在这一章中，我们将看一些 可用的命令行工具，这些工具帮助我们查看程序的执行状态，以及怎样终止行为不当的进程。

2. 进程是怎样工作的


    当系统启动的时候，内核先把一些它自己的程序初始化为进程，然后运行一个叫做 init 的程序。init， 依次地，再运行一系列的称为 init 脚本的 shell 脚本（位于/etc），它们可以启动所有的系统服务。 其中许多系统服务以守护（daemon）程序的形式实现，守护程序仅在后台运行，没有任何用户接口。 这样，即使我们没有登录系统，至少系统也在忙于执行一些例行事务。

    一个程序可以发动另一个程序，这个事实在进程方案中，表述为一个父进程创建了一个子进程。

    内核维护每个进程的信息，以此来保持事情有序。例如，系统分配给每个进程一个数字，这个数字叫做 进程 ID 或 PID。PID 号按升序分配，init 进程的 PID 总是1。内核也对分配给每个进程的内存进行跟踪。 像文件一样，进程也有所有者和用户 ID，有效用户 ID，等等。
    
3. ps – 报告当前进程快照

	```
	rimideiMac-10:test admin$ ps
	  PID TTY           TIME CMD
	 4506 ttys000    0:00.04 -bash
	 4533 ttys001    0:00.25 -bash
	 
	```
	
	>上例中，列出了两个进程，进程 4506 和进程 4533，各自代表命令 bash 和 ps。正如我们所看到的， 默认情况下，ps 不会显示很多进程信息，只是列出与当前终端会话相关的进程。
	
	1. 如果给 ps 命令加上选项，我们可以得到更多关于系统运行状态的信息：
		
		```
		rimideiMac-10:test admin$ ps x
		  PID   TT  STAT      TIME COMMAND
		  385   ??  S      0:06.06 /usr/sbin/cfprefsd agent
		  386   ??  S      0:09.18 /usr/libexec/UserEventAgent (Aqua)
		  388   ??  S      1:19.98 /usr/sbin/distnoted agent
	
		```
		>加上 “x” 选项（注意没有开头的 “-” 字符），告诉 ps 命令，展示所有进程，
		
		STAT表示进程的状态
		
		
	  |状态|  	  意义|  
	  |---|---|
	  |R | 	  运行。这意味着，进程正在运行或准备运行。   
	  |S  |	  正在睡眠。 进程没有运行，而是，正在等待一个事件， 比如说，一个按键或者网络数据包。   
	  |D  	|  不可中断睡眠。进程正在等待 I/O，比方说，一个磁盘驱动器的 I/O。  
	  |T  	 | 已停止. 已经指示进程停止运行。稍后介绍更多。  
	  |Z  	 | 一个死进程或“僵尸”进程。这是一个已经终止的子进程，但是它的父进程还没有清空它。 （父进程没有把子进程从进程表中删除）  
	  |<  	  |一个高优先级进程。这可能会授予一个进程更多重要的资源，给它更多的 CPU 时间。 进程的这种属性叫做 niceness。具有高优先级的进程据说是不好的（less nice）， 因为它占用了比较多的 CPU 时间，这样就给其它进程留下很少时间。   
	  |N  	  | 低优先级进程。 一个低优先级进程（一个“好”进程）只有当其它高优先级进程执行之后，才会得到处理器时间。
  
  2. 另一个流行的选项组合是 “aux”（不带开头的”-“字符）。这会给我们更多信息：

	  	```
	  	rimideiMac-10:test admin$ ps aux
		USER               PID  %CPU %MEM      VSZ    RSS   TT  STAT STARTED      TIME COMMAND
		admin              432 100.0  0.3  4566564  27932   ??  R    日03下午 201:51.72 /System/Library/CoreServices/Dock.app/Contents/MacOS/Dock
		admin              113  99.3  0.4  4563544  31160   ??  Rs   日03下午 655:29.85 /System/Library/CoreServices/loginwindow.app/Contents/MacOS/login
		admin             5119   1.6  1.8  4983908 147960   ??  S     3:02下午   0:29.01 /Applications/Google Chrome.app/Contents/Versions/68.0.3440.106/G
		_windowserver      174   0.9  0.7  5638312  59348   ??  Ss   日03下午  20:16.25 /System/Library/PrivateFrameworks/SkyLight.framework/R
	  	```
	  	
	  	>这个选项组合，能够显示属于每个用户的进程信息。
	  	
	  	
	  |标题 | 	  意思|
	  |---|---|  
	  |USER|  	  用户 ID. 进程的所有者。   
	  |%CPU | 	  以百分比表示的 CPU 使用率  
	  |%MEM  |	  以百分比表示的内存使用率  
	  |VSZ  	|  虚拟内存大小  
	  |RSS  	 | 进程占用的物理内存的大小，以千字节为单位。  
	  |START  	|  进程运行的起始时间。若超过24小时，则用天表示。  
  	
  	3. 查找某个程序特定的程序

  		```
  		rimideiMac-10:test admin$ ps -ef|grep redis
  503   540     1   0 日03下午 ??         0:08.94 /usr/local/opt/redis/bin/redis-server 0.0.0.0:6379  
  503  5403  4533   0  3:27下午 ttys001    0:00.00 grep redis
  		```
	
	
    4. top – 显示任务
	
		虽然 ps 命令能够展示许多计算机运行状态的信息，但是它只是提供，ps 命令执行时刻的机器状态快照。 为了看到更多动态的信息，我们使用 top 命令：
	
		```
		$ top
		```
	5. bg – 

	    把一个任务放到后台执行
	在后台运行程序 也可以使用 & 执行
	
	6. kill – 给一个进程发送信号
	
		```
		kill 9527
		```
	
	7. shutdown – 关机或重启系统

